<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>English Learning Game - Fun Education</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary-color: #FF6B6B;
            --secondary-color: #4ECDC4;
            --accent-color: #FFE66D;
            --dark-color: #292F36;
            --light-color: #F7FFF7;
        }
        
        body {
            font-family:  'Nunito', sans-serif;
            background-color: var(--light-color);
            color: var(--dark-color);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }
        
        .navbar {
            background-color: var(--primary-color) !important;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }
        
        .navbar-brand {
            font-size: 1.5rem;
            font-weight: bold;
        }
        
        .quiz-card {
            border-radius: 20px;
            border: none;
            box-shadow: 0 6px 12px rgba(0,0,0,0.15);
            overflow: hidden;
            background-color: white;
        }
        
        .question-container {
            min-height: 200px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 20px;
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            border-radius: 15px;
            margin: 15px 0;
            position: relative;
        }
        
        .question-container::before {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 5px;
            background: linear-gradient(90deg, var(--primary-color), var(--secondary-color));
        }
        
        .option-btn {
            font-size: 1.2rem;
            transition: all 0.3s;
            margin: 8px;
            min-width: 120px;
            border-radius: 50px !important;
            padding: 12px 20px;
            border: 2px solid var(--secondary-color);
            background-color: white;
            color: var(--dark-color);
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }
        
        .option-btn:hover {
            transform: translateY(-5px) scale(1.05);
            box-shadow: 0 8px 15px rgba(0,0,0,0.2);
        }
        
        .option-btn:active {
            transform: translateY(0) scale(0.98);
        }
        
        .emoji-display {
            font-size: 4rem;
            margin: 15px 0;
            transition: all 0.3s;
        }
        
        .progress {
            height: 25px;
            border-radius: 10px;
            background-color: #e9ecef;
            margin: 20px 0;
        }
        
        .progress-bar {
            border-radius: 10px;
            background: linear-gradient(90deg, var(--primary-color), var(--secondary-color));
            transition: width 0.6s ease;
        }
        
        @keyframes bounce {
            0%, 20%, 50%, 80%, 100% {transform: translateY(0);}
            40% {transform: translateY(-15px);}
            60% {transform: translateY(-7px);}
        }
        
        .bounce {
            animation: bounce 0.8s;
        }
        
        @keyframes shake {
            0%, 100% {transform: translateX(0);}
            10%, 30%, 50%, 70%, 90% {transform: translateX(-8px);}
            20%, 40%, 60%, 80% {transform: translateX(8px);}
        }
        
        .shake {
            animation: shake 0.6s;
        }
        
        .audio-btn {
            cursor: pointer;
            transition: all 0.3s;
            color: var(--primary-color);
            background-color: var(--accent-color);
            width: 60px;
            height: 60px;
            border-radius: 50%;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            margin-top: 15px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
            font-size: 1.5rem;
        }
        
        .audio-btn:hover {
            color: white;
            background-color: var(--primary-color);
            transform: scale(1.1) rotate(10deg);
            box-shadow: 0 8px 15px rgba(0,0,0,0.2);
        }
        
        .nav-pills .nav-link {
            font-size: 1.1rem;
            padding: 10px 20px;
            margin: 0 5px;
            border-radius: 50px !important;
            color: var(--dark-color);
            background-color: white;
            border: 2px solid var(--secondary-color);
            transition: all 0.3s;
        }
        
        .nav-pills .nav-link.active {
            background-color: var(--primary-color);
            font-weight: bold;
            color: white;
            border: 2px solid var(--primary-color);
            transform: translateY(-3px);
            box-shadow: 0 5px 10px rgba(0,0,0,0.1);
        }
        
        .nav-pills .nav-link:hover:not(.active) {
            transform: translateY(-3px);
            box-shadow: 0 5px 10px rgba(0,0,0,0.1);
        }
        
        .btn-primary {
            background-color: var(--primary-color);
            border-color: var(--primary-color);
            font-weight: bold;
            padding: 15px 30px;
            border-radius: 50px;
            font-size: 1.2rem;
            box-shadow: 0 6px 12px rgba(0,0,0,0.1);
            transition: all 0.3s;
        }
        
        .btn-primary:hover {
            background-color: #FF5252;
            border-color: #FF5252;
            transform: translateY(-5px) scale(1.05);
            box-shadow: 0 12px 20px rgba(255,107,107,0.3);
        }
        
        .btn-primary:active {
            transform: translateY(0) scale(0.98);
        }
        
        .score-display {
            font-size: 1.3rem;
            font-weight: bold;
            background-color: var(--accent-color);
            padding: 8px 15px;
            border-radius: 50px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }
        
        .timer-container {
            position: relative;
            width: 80px;
            height: 80px;
            margin: 0 auto 20px;
        }
        
        .timer-circle {
            width: 100%;
            height: 100%;
            transform: rotate(-90deg);
        }
        
        .timer-bg {
            fill: none;
            stroke: #e9ecef;
            stroke-width: 8;
        }
        
        .timer-progress {
            fill: none;
            stroke: var(--primary-color);
            stroke-width: 8;
            stroke-linecap: round;
            transition: stroke-dashoffset 1s linear;
        }
        
        .timer-text {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 1.5rem;
            font-weight: bold;
            color: var(--dark-color);
        }
        
        .confetti {
            position: absolute;
            width: 10px;
            height: 10px;
            background-color: var(--primary-color);
            opacity: 0;
        }
        
        .game-over {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: rgba(0,0,0,0.8);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.5s;
        }
        
        .game-over.show {
            opacity: 1;
            pointer-events: all;
        }
        
        .game-over-content {
            background-color: white;
            padding: 30px;
            border-radius: 20px;
            text-align: center;
            max-width: 500px;
            width: 90%;
            box-shadow: 0 10px 25px rgba(0,0,0,0.2);
            transform: scale(0.8);
            transition: transform 0.5s;
        }
        
        .game-over.show .game-over-content {
            transform: scale(1);
        }
        
        .star-rating {
            font-size: 2rem;
            color: #FFD700;
            margin: 15px 0;
        }
        
        .star-rating .far {
            opacity: 0.3;
        }
        
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }
        
        .pulse {
            animation: pulse 1s infinite;
        }

        /* Word Scramble Game */
        .word-scramble-container {
            display: none;
            flex-direction: column;
            align-items: center;
            margin: 20px 0;
        }

        .scrambled-word {
            font-size: 2rem;
            font-weight: bold;
            letter-spacing: 10px;
            margin-bottom: 20px;
            padding: 10px 20px;
            background-color: #f8f9fa;
            border-radius: 10px;
        }

        .scramble-input {
            font-size: 1.5rem;
            padding: 10px 15px;
            border-radius: 10px;
            border: 2px solid var(--secondary-color);
            text-align: center;
            margin-bottom: 15px;
        }

        .scramble-feedback {
            font-size: 1.2rem;
            font-weight: bold;
            min-height: 30px;
            margin-bottom: 15px;
        }
    </style>
</head>
<body>
    <!-- Navigation -->
    <nav class="navbar navbar-expand-lg navbar-light sticky-top">
        <div class="container">
            <a class="navbar-brand text-white fw-bold" href="index.html">
                <i class="fas fa-arrow-left me-2"></i>Back 
            </a>
            <div class="ms-auto d-flex align-items-center">
                <span class="score-display me-3">
                    <i class="fas fa-star me-2"></i>
                    <span id="score">0</span>/<span id="total-questions">0</span>
                </span>
                <div class="timer-container">
                    <svg class="timer-circle" viewBox="0 0 36 36">
                        <circle class="timer-bg" cx="18" cy="18" r="16"></circle>
                        <circle class="timer-progress" cx="18" cy="18" r="16" stroke-dasharray="100" stroke-dashoffset="100"></circle>
                    </svg>
                    <div class="timer-text" id="timer">30</div>
                </div>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <main class="container my-4 flex-grow-1">
        <div class="row justify-content-center">
            <div class="col-lg-10">
                <div class="card quiz-card">
                    <div class="card-body">
                        <h2 class="card-title text-center mb-4 fw-bold">English Learning Games</h2>
                        
                        <ul class="nav nav-pills mb-4 justify-content-center" id="quizTab">
                            <li class="nav-item">
                                <a class="nav-link active" id="letters-tab" data-bs-toggle="pill" href="#letters-quiz">
                                    <i class="fas fa-font me-2"></i>Letters
                                </a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link" id="numbers-tab" data-bs-toggle="pill" href="#numbers-quiz">
                                    <i class="fas fa-sort-numeric-up me-2"></i>Numbers
                                </a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link" id="colors-tab" data-bs-toggle="pill" href="#colors-quiz">
                                    <i class="fas fa-palette me-2"></i>Colors
                                </a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link" id="scramble-tab" data-bs-toggle="pill" href="#scramble-game">
                                    <i class="fas fa-random me-2"></i>Word Scramble
                                </a>
                            </li>
                        </ul>
                        
                        <div class="tab-content" id="quizTabContent">
                            <!-- Letters -->
                            <div class="tab-pane fade show active" id="letters-quiz">
                                <div class="question-container text-center py-4">
                                    <h4 id="letters-question" class="mb-4 fw-bold">Which letter is this?</h4>
                                    <div id="letters-display" class="emoji-display">A</div>
                                    <div class="audio-btn" id="play-letters">
                                        <i class="fas fa-volume-up"></i>
                                    </div>
                                </div>
                                
                                <div class="d-flex flex-wrap justify-content-center mb-4" id="letters-options">
                                    <button class="btn btn-outline-primary option-btn">A</button>
                                    <button class="btn btn-outline-primary option-btn">B</button>
                                    <button class="btn btn-outline-primary option-btn">C</button>
                                    <button class="btn btn-outline-primary option-btn">D</button>
                                </div>
                                
                                <p id="letters-feedback" class="text-center fw-bold fs-4 mb-4"></p>
                            </div>
                            
                            <!-- Numbers -->
                            <div class="tab-pane fade" id="numbers-quiz">
                                <div class="question-container text-center py-4">
                                    <h4 id="numbers-question" class="mb-4 fw-bold">Which number is this?</h4>
                                    <div id="numbers-display" class="emoji-display">1️⃣</div>
                                    <div class="audio-btn" id="play-numbers">
                                        <i class="fas fa-volume-up"></i>
                                    </div>
                                </div>
                                
                                <div class="d-flex flex-wrap justify-content-center mb-4" id="numbers-options">
                                    <button class="btn btn-outline-primary option-btn">One</button>
                                    <button class="btn btn-outline-primary option-btn">Two</button>
                                    <button class="btn btn-outline-primary option-btn">Three</button>
                                    <button class="btn btn-outline-primary option-btn">Four</button>
                                </div>
                                
                                <p id="numbers-feedback" class="text-center fw-bold fs-4 mb-4"></p>
                            </div>
                            
                            <!-- Colors -->
                            <div class="tab-pane fade" id="colors-quiz">
                                <div class="question-container text-center py-4">
                                    <h4 id="colors-question" class="mb-4 fw-bold">Which color is this?</h4>
                                    <div id="colors-display" class="emoji-display" style="color: #FF0000;">🔴</div>
                                    <div class="audio-btn" id="play-colors">
                                        <i class="fas fa-volume-up"></i>
                                    </div>
                                </div>
                                
                                <div class="d-flex flex-wrap justify-content-center mb-4" id="colors-options">
                                    <button class="btn btn-outline-primary option-btn">Red</button>
                                    <button class="btn btn-outline-primary option-btn">Blue</button>
                                    <button class="btn btn-outline-primary option-btn">Green</button>
                                    <button class="btn btn-outline-primary option-btn">Yellow</button>
                                </div>
                                
                                <p id="colors-feedback" class="text-center fw-bold fs-4 mb-4"></p>
                            </div>
                            
                            <!-- Word Scramble Game -->
                            <div class="tab-pane fade" id="scramble-game">
                                <div class="question-container text-center py-4">
                                    <h4 class="mb-4 fw-bold">Word Scramble</h4>
                                    <p>Unscramble the letters to form an English word!</p>
                                    <div class="word-scramble-container" id="word-scramble-container">
                                        <div class="scrambled-word" id="scrambled-word"></div>
                                        <input type="text" class="scramble-input" id="scramble-input" placeholder="Your answer">
                                        <div class="scramble-feedback" id="scramble-feedback"></div>
                                        <button class="btn btn-primary" id="scramble-submit">Submit</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="progress mb-4">
                            <div id="progress-bar" class="progress-bar progress-bar-striped" role="progressbar" style="width: 0%"></div>
                        </div>
                        
                        <div class="text-center">
                            <button id="next-btn" class="btn btn-primary">
                                Next Question <i class="fas fa-forward ms-2"></i>
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- Game Over Modal -->
    <div class="game-over" id="game-over">
        <div class="game-over-content">
            <h2 class="fw-bold mb-3">Game Completed!</h2>
            <div class="star-rating">
                <i class="fas fa-star"></i>
                <i class="fas fa-star"></i>
                <i class="fas fa-star"></i>
                <i class="far fa-star"></i>
                <i class="far fa-star"></i>
            </div>
            <p class="fs-4">Final Score: <span id="final-score">0</span> out of <span id="final-total">0</span></p>
            <div class="d-flex justify-content-center mt-4">
                <button id="restart-btn" class="btn btn-primary me-3">
                    <i class="fas fa-redo me-2"></i>Play Again
                </button>
                <button id="quit-btn" class="btn btn-outline-secondary">
                    <i class="fas fa-home me-2"></i>Quit
                </button>
            </div>
        </div>
    </div>

    <!-- Audio Element -->
    <audio id="audio-element"></audio>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    
<script>
    // Data for quizzes
    const quizData = {
        letters: [
            { letter: "A", question: "Which letter is this?", options: ["A", "B", "C", "D"], answer: "A" },
            { letter: "B", question: "Which letter is this?", options: ["A", "B", "D", "F"], answer: "B" },
            { letter: "C", question: "Which letter is this?", options: ["C", "G", "O", "Q"], answer: "C" },
            { letter: "D", question: "Which letter is this?", options: ["B", "D", "P", "Q"], answer: "D" },
            { letter: "E", question: "Which letter is this?", options: ["E", "F", "L", "T"], answer: "E" },
            { letter: "M", question: "Which letter is this?", options: ["M", "N", "W", "H"], answer: "M" },
            { letter: "S", question: "Which letter is this?", options: ["S", "Z", "X", "Y"], answer: "S" },
            { letter: "T", question: "Which letter is this?", options: ["T", "F", "L", "I"], answer: "T" },
            { letter: "P", question: "Which letter is this?", options: ["P", "B", "D", "R"], answer: "P" },
            { letter: "K", question: "Which letter is this?", options: ["K", "H", "X", "Y"], answer: "K" }
        ],
        numbers: [
            { emoji: "1️⃣", word: "One", question: "Which number is this?", options: ["One", "Two", "Three", "Four"], answer: "One" },
            { emoji: "2️⃣", word: "Two", question: "Which number is this?", options: ["One", "Two", "Ten", "Twelve"], answer: "Two" },
            { emoji: "3️⃣", word: "Three", question: "Which number is this?", options: ["Three", "Four", "Five", "Six"], answer: "Three" },
            { emoji: "4️⃣", word: "Four", question: "Which number is this?", options: ["Two", "Four", "Six", "Eight"], answer: "Four" },
            { emoji: "5️⃣", word: "Five", question: "Which number is this?", options: ["Five", "Seven", "Nine", "Ten"], answer: "Five" },
            { emoji: "6️⃣", word: "Six", question: "Which number is this?", options: ["Four", "Six", "Eight", "Ten"], answer: "Six" },
            { emoji: "7️⃣", word: "Seven", question: "Which number is this?", options: ["Five", "Seven", "Nine", "Eleven"], answer: "Seven" },
            { emoji: "8️⃣", word: "Eight", question: "Which number is this?", options: ["Six", "Eight", "Ten", "Twelve"], answer: "Eight" },
            { emoji: "9️⃣", word: "Nine", question: "Which number is this?", options: ["Seven", "Nine", "Eleven", "Thirteen"], answer: "Nine" },
            { emoji: "🔟", word: "Ten", question: "Which number is this?", options: ["Eight", "Ten", "Twelve", "Twenty"], answer: "Ten" }
        ],
        colors: [
            { emoji: "🔴", color: "Red", question: "Which color is this?", options: ["Red", "Blue", "Green", "Yellow"], answer: "Red" },
            { emoji: "🔵", color: "Blue", question: "Which color is this?", options: ["Red", "Blue", "Purple", "Pink"], answer: "Blue" },
            { emoji: "🟡", color: "Yellow", question: "Which color is this?", options: ["Yellow", "Orange", "White", "Gold"], answer: "Yellow" },
            { emoji: "🟢", color: "Green", question: "Which color is this?", options: ["Green", "Blue", "Purple", "Brown"], answer: "Green" },
            { emoji: "🟠", color: "Orange", question: "Which color is this?", options: ["Orange", "Red", "Yellow", "Pink"], answer: "Orange" },
            { emoji: "🟣", color: "Purple", question: "Which color is this?", options: ["Purple", "Blue", "Pink", "Brown"], answer: "Purple" },
            { emoji: "⚫", color: "Black", question: "Which color is this?", options: ["Black", "Gray", "Blue", "Purple"], answer: "Black" },
            { emoji: "⚪", color: "White", question: "Which color is this?", options: ["White", "Yellow", "Pink", "Gray"], answer: "White" },
            { emoji: "🟤", color: "Brown", question: "Which color is this?", options: ["Brown", "Black", "Gray", "Green"], answer: "Brown" },
            { emoji: "🔘", color: "Gray", question: "Which color is this?", options: ["Gray", "Black", "White", "Blue"], answer: "Gray" }
        ]
    };

    // Word Scramble Data
    const scrambleWords = [
        "apple", "banana", "orange", "elephant", "giraffe", 
        "computer", "teacher", "student", "pencil", "notebook"
    ];

    // Game state
    const gameState = {
        currentCategory: 'letters',
        currentQuestion: 0,
        score: 0,
        answeredQuestions: [],
        time: 30,
        timer: null,
        gameActive: true,
        // Word Scramble State
        currentScrambleWord: "",
        scrambledLetters: []
    };

    // DOM Elements
    const elements = {
        score: document.getElementById('score'),
        totalQuestions: document.getElementById('total-questions'),
        timerText: document.getElementById('timer'),
        timerProgress: document.querySelector('.timer-progress'),
        progressBar: document.getElementById('progress-bar'),
        gameOverModal: document.getElementById('game-over'),
        finalScore: document.getElementById('final-score'),
        finalTotal: document.getElementById('final-total'),
        starRating: document.querySelector('.star-rating'),
        audioElement: document.getElementById('audio-element')
    };

    // Initialize game
    function initGame() {
        // Set total questions
        const totalQuestions = Object.values(quizData).reduce((acc, curr) => acc + curr.length, 0) + scrambleWords.length;
        elements.totalQuestions.textContent = totalQuestions;
        
        // Event listeners for tabs
        const tabEls = document.querySelectorAll('a[data-bs-toggle="pill"]');
        tabEls.forEach(tabEl => {
            tabEl.addEventListener('shown.bs.tab', (event) => {
                const category = event.target.getAttribute('href').substring(1).replace('-quiz', '').replace('-game', '');
                gameState.currentCategory = category;
                
                if (category === 'scramble') {
                    initWordScramble();
                } else {
                    gameState.currentQuestion = 0;
                    resetTimer();
                    loadQuestion();
                }
            });
        });
        
        // Next question button - UPDATED to always allow clicking
        document.getElementById('next-btn').addEventListener('click', () => {
            loadQuestion();
            resetTimer();
        });
        
        // Audio buttons
        document.getElementById('play-letters').addEventListener('click', () => playAudio(gameState.currentQuestionItem.letter));
        document.getElementById('play-numbers').addEventListener('click', () => playAudio(gameState.currentQuestionItem.word));
        document.getElementById('play-colors').addEventListener('click', () => playAudio(gameState.currentQuestionItem.color));
        
        // Game over buttons
        document.getElementById('restart-btn').addEventListener('click', restartGame);
        document.getElementById('quit-btn').addEventListener('click', () => window.location.href = 'index.html');
        
        // Word scramble submit
        document.getElementById('scramble-submit').addEventListener('click', checkScrambleAnswer);
        document.getElementById('scramble-input').addEventListener('keypress', (e) => {
            if (e.key === 'Enter') {
                checkScrambleAnswer();
            }
        });
        
        // Load first question
        loadQuestion();
        startTimer();
    }

    // Load question
    function loadQuestion() {
        // Reset game state
        gameState.gameActive = true;
        
        if (gameState.currentCategory === 'scramble') {
            return;
        }
        
        // Reset feedback
        const feedbackEl = document.getElementById(`${gameState.currentCategory}-feedback`);
        feedbackEl.textContent = '';
        feedbackEl.className = "text-center fw-bold fs-4 mb-4";
        
        // Get random unanswered question
        const availableQuestions = quizData[gameState.currentCategory].filter((_, index) => 
            !gameState.answeredQuestions.some(q => q.category === gameState.currentCategory && q.index === index)
        );
        
        // If all questions answered, show game over
        if (availableQuestions.length === 0) {
            endGame();
            return;
        }
        
        const randomIndex = Math.floor(Math.random() * availableQuestions.length);
        const questionIndex = quizData[gameState.currentCategory].indexOf(availableQuestions[randomIndex]);
        
        gameState.currentQuestion = questionIndex;
        gameState.currentQuestionItem = quizData[gameState.currentCategory][questionIndex];
        
        // Update display based on category
        switch(gameState.currentCategory) {
            case 'letters':
                document.getElementById('letters-question').textContent = gameState.currentQuestionItem.question;
                document.getElementById('letters-display').textContent = gameState.currentQuestionItem.letter;
                updateOptions('letters', gameState.currentQuestionItem.options);
                break;
            case 'numbers':
                document.getElementById('numbers-question').textContent = gameState.currentQuestionItem.question;
                document.getElementById('numbers-display').textContent = gameState.currentQuestionItem.emoji;
                updateOptions('numbers', gameState.currentQuestionItem.options);
                break;
            case 'colors':
                document.getElementById('colors-question').textContent = gameState.currentQuestionItem.question;
                const colorDisplay = document.getElementById('colors-display');
                colorDisplay.textContent = gameState.currentQuestionItem.emoji;
                // Remove any existing color class
                colorDisplay.className = "emoji-display";
                // Add color if it's a colored emoji
                if (gameState.currentQuestionItem.emoji === "🔴") colorDisplay.style.color = "#FF0000";
                if (gameState.currentQuestionItem.emoji === "🔵") colorDisplay.style.color = "#0000FF";
                if (gameState.currentQuestionItem.emoji === "🟡") colorDisplay.style.color = "#FFFF00";
                if (gameState.currentQuestionItem.emoji === "🟢") colorDisplay.style.color = "#00FF00";
                if (gameState.currentQuestionItem.emoji === "🟠") colorDisplay.style.color = "#FFA500";
                if (gameState.currentQuestionItem.emoji === "🟣") colorDisplay.style.color = "#800080";
                updateOptions('colors', gameState.currentQuestionItem.options);
                break;
        }
        
        // Update progress bar
        const progress = (gameState.answeredQuestions.length / elements.totalQuestions.textContent) * 100;
        elements.progressBar.style.width = `${progress}%`;
    }

    // Update answer options
    function updateOptions(category, options) {
        const optionsContainer = document.getElementById(`${category}-options`);
        optionsContainer.innerHTML = '';
        
        // Shuffle options
        const shuffledOptions = [...options].sort(() => Math.random() - 0.5);
        
        shuffledOptions.forEach(option => {
            const button = document.createElement('button');
            button.className = "btn btn-outline-primary option-btn";
            button.textContent = option;
            button.addEventListener('click', () => checkAnswer(option, category));
            optionsContainer.appendChild(button);
        });
    }

    // Check answer - UPDATED to enable next question
    function checkAnswer(selectedOption, category) {
        if (!gameState.gameActive) return;
        
        const correctAnswer = gameState.currentQuestionItem.answer;
        const feedbackEl = document.getElementById(`${category}-feedback`);
        
        if (selectedOption === correctAnswer) {
            // Correct answer
            feedbackEl.textContent = "Correct! 🎉";
            feedbackEl.className = "text-center fw-bold fs-4 mb-4 text-success";
            gameState.score++;
            elements.score.textContent = gameState.score;
            
            // Add bounce animation to feedback
            feedbackEl.classList.add('bounce');
            setTimeout(() => feedbackEl.classList.remove('bounce'), 1000);
            
            // Create confetti effect
            createConfetti();
        } else {
            // Wrong answer
            feedbackEl.textContent = `Wrong! The correct answer is ${correctAnswer}.`;
            feedbackEl.className = "text-center fw-bold fs-4 mb-4 text-danger";
            
            // Add shake animation to feedback
            feedbackEl.classList.add('shake');
            setTimeout(() => feedbackEl.classList.remove('shake'), 1000);
        }
        
        // Mark question as answered
        gameState.answeredQuestions.push({
            category: gameState.currentCategory,
            index: gameState.currentQuestion
        });
        
        // Disable all option buttons
        const optionButtons = document.querySelectorAll(`#${category}-options .option-btn`);
        optionButtons.forEach(button => {
            button.disabled = true;
            if (button.textContent === correctAnswer) {
                button.classList.add('btn-success');
                button.classList.remove('btn-outline-primary');
            } else if (button.textContent === selectedOption && selectedOption !== correctAnswer) {
                button.classList.add('btn-danger');
                button.classList.remove('btn-outline-primary');
            }
        });
        
        // Stop timer but allow next question
        clearInterval(gameState.timer);
    }

    // Timer functions
    function startTimer() {
        gameState.time = 30;
        elements.timerText.textContent = gameState.time;
        elements.timerProgress.setAttribute('stroke-dashoffset', '0');
        
        gameState.timer = setInterval(() => {
            gameState.time--;
            elements.timerText.textContent = gameState.time;
            
            // Update circle progress
            const offset = (gameState.time / 30) * 100;
            elements.timerProgress.setAttribute('stroke-dashoffset', offset);
            
            if (gameState.time <= 0) {
                clearInterval(gameState.timer);
                timeUp();
            }
        }, 1000);
    }

    function resetTimer() {
        clearInterval(gameState.timer);
        gameState.gameActive = true;
        startTimer();
    }

    function timeUp() {
        if (!gameState.gameActive) return;
        
        const category = gameState.currentCategory;
        const feedbackEl = document.getElementById(`${category}-feedback`);
        const correctAnswer = gameState.currentQuestionItem.answer;
        
        feedbackEl.textContent = `Time's up! The correct answer is ${correctAnswer}.`;
        feedbackEl.className = "text-center fw-bold fs-4 mb-4 text-danger";
        
        // Mark question as answered
        gameState.answeredQuestions.push({
            category: gameState.currentCategory,
            index: gameState.currentQuestion
        });
        
        // Highlight correct answer
        const optionButtons = document.querySelectorAll(`#${category}-options .option-btn`);
        optionButtons.forEach(button => {
            button.disabled = true;
            if (button.textContent === correctAnswer) {
                button.classList.add('btn-success');
                button.classList.remove('btn-outline-primary');
            }
        });
        
        // Allow next question
        gameState.gameActive = true;
    }

    // Word Scramble functions
    function initWordScramble() {
        const container = document.getElementById('word-scramble-container');
        container.style.display = 'flex';
        
        // Select a random word
        const randomIndex = Math.floor(Math.random() * scrambleWords.length);
        gameState.currentScrambleWord = scrambleWords[randomIndex];
        gameState.scrambledLetters = scrambleWord(gameState.currentScrambleWord);
        
        // Display scrambled word
        document.getElementById('scrambled-word').textContent = gameState.scrambledLetters.join(' ');
        document.getElementById('scramble-input').value = '';
        document.getElementById('scramble-feedback').textContent = '';
    }

    function scrambleWord(word) {
        const letters = word.split('');
        // Shuffle letters but make sure it's not the same as original
        let scrambled;
        do {
            scrambled = [...letters].sort(() => Math.random() - 0.5);
        } while (scrambled.join('') === word);
        
        return scrambled;
    }

    function checkScrambleAnswer() {
        const userAnswer = document.getElementById('scramble-input').value.toLowerCase().trim();
        const feedbackEl = document.getElementById('scramble-feedback');
        
        if (userAnswer === gameState.currentScrambleWord) {
            // Correct answer
            feedbackEl.textContent = "Correct! 🎉";
            feedbackEl.className = "text-center fw-bold fs-4 mb-4 text-success";
            gameState.score++;
            elements.score.textContent = gameState.score;
            
            // Create confetti effect
            createConfetti();
            
            // Mark as answered
            gameState.answeredQuestions.push({
                category: 'scramble',
                index: scrambleWords.indexOf(gameState.currentScrambleWord)
            });
            
            // Load new word after delay
            setTimeout(initWordScramble, 1500);
        } else {
            // Wrong answer
            feedbackEl.textContent = "Try again!";
            feedbackEl.className = "text-center fw-bold fs-4 mb-4 text-danger";
        }
    }

    // Audio functions
    function playAudio(text) {
        const utterance = new SpeechSynthesisUtterance(text);
        utterance.lang = 'en-US';
        utterance.rate = 0.8;
        speechSynthesis.speak(utterance);
    }

    // Confetti effect
    function createConfetti() {
        const container = document.querySelector('.question-container');
        
        for (let i = 0; i < 50; i++) {
            const confetti = document.createElement('div');
            confetti.className = 'confetti';
            confetti.style.left = Math.random() * 100 + '%';
            confetti.style.backgroundColor = getRandomColor();
            confetti.style.transform = `rotate(${Math.random() * 360}deg)`;
            container.appendChild(confetti);
            
            // Animate
            setTimeout(() => {
                confetti.style.opacity = '1';
                confetti.style.top = '100%';
                confetti.style.transition = `top ${Math.random() * 2 + 1}s linear, opacity ${Math.random() * 2 + 1}s linear`;
                
                // Remove after animation
                setTimeout(() => {
                    confetti.remove();
                }, 3000);
            }, 0);
        }
    }

    function getRandomColor() {
        const colors = ['#FF6B6B', '#4ECDC4', '#FFE66D', '#FFA5A5', '#88D8B0'];
        return colors[Math.floor(Math.random() * colors.length)];
    }

    // End game
    function endGame() {
        clearInterval(gameState.timer);
        
        // Calculate stars (1-5)
        const totalQuestions = parseInt(elements.totalQuestions.textContent);
        const percentage = (gameState.score / totalQuestions) * 100;
        const stars = Math.ceil(percentage / 20);
        
        // Update stars display
        const starIcons = elements.starRating.querySelectorAll('i');
        starIcons.forEach((star, index) => {
            if (index < stars) {
                star.classList.remove('far');
                star.classList.add('fas');
            } else {
                star.classList.remove('fas');
                star.classList.add('far');
            }
        });
        
        // Update final score
        elements.finalScore.textContent = gameState.score;
        elements.finalTotal.textContent = totalQuestions;
        
        // Show game over modal
        elements.gameOverModal.classList.add('show');
    }

    // Restart game
    function restartGame() {
        // Reset game state
        gameState.currentCategory = 'letters';
        gameState.currentQuestion = 0;
        gameState.score = 0;
        gameState.answeredQuestions = [];
        gameState.time = 30;
        gameState.gameActive = true;
        
        // Update UI
        elements.score.textContent = '0';
        elements.progressBar.style.width = '0%';
        elements.gameOverModal.classList.remove('show');
        
        // Load first question
        loadQuestion();
        resetTimer();
    }

    // Initialize the game when DOM is loaded
    document.addEventListener('DOMContentLoaded', initGame);
</script>

</body>
</html>